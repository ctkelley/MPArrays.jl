<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · MultiPrecisionArrays.jl</title><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>MultiPrecisionArrays.jl</a></span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a><ul class="internal"><li><a class="tocitem" href="#What-is-iterative-refinement."><span>What is iterative refinement.</span></a></li></ul></li><li><span class="tocitem">Factorizations</span><ul><li><a class="tocitem" href="functions/mplu!/">mplu!: Simple MPArray factorization</a></li><li><a class="tocitem" href="functions/hlu!/">hlu!: Get LU to perform reasonably well for Float16</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/ctkelley/MultiPrecisionArrays.jl/blob/main/docs/src/index.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="MultiPrecisionArrays.jl-v0.0.4"><a class="docs-heading-anchor" href="#MultiPrecisionArrays.jl-v0.0.4">MultiPrecisionArrays.jl v0.0.4</a><a id="MultiPrecisionArrays.jl-v0.0.4-1"></a><a class="docs-heading-anchor-permalink" href="#MultiPrecisionArrays.jl-v0.0.4" title="Permalink"></a></h1><p><a href="https://ctk.math.ncsu.edu">C. T. Kelley</a></p><p><a href="https://github.com/ctkelley/MultiPrecisionArrays.jl">MultiPrecisionArrays.jl</a> is a package for iterative refinement. </p><p>This package provides data atructures and solvers for several variants of iterative refinement. It will become much more useful when half precision (aka <code>Float16</code>) is fully supported in LAPACK/BLAS. For now, it&#39;s only general-purpose application is classical iterative refinement with double precision equations and single precision factorizations.</p><p>The half precision stuff is good for those of us doing research in this field. Half precision performace has progressed to the point where you can acutally get things done. On an Apple M2-Pro, a half precision LU only costs 3–5 times what a double precision LU costs. This may be as good as it gets unless someone wants to duplicate the LAPACK implementation and get the benefits from blocking, recursion, and clever cache management.</p><p>We use a hack-job LU factorization for half precision. Look at the source for <strong>hlu!.jl</strong>.</p><h2 id="What-is-iterative-refinement."><a class="docs-heading-anchor" href="#What-is-iterative-refinement.">What is iterative refinement.</a><a id="What-is-iterative-refinement.-1"></a><a class="docs-heading-anchor-permalink" href="#What-is-iterative-refinement." title="Permalink"></a></h2><p>The idea is to solve <span>$Ax=b$</span> in high precision using a factorization in lower precision. </p><p><strong>IR(A, b)</strong></p><ul><li><p class="math-container">\[x = 0\]</p></li><li><p class="math-container">\[r = b\]</p></li><li>Factor <span>$A = LU$</span> in a lower precision</li><li>While <span>$\| r \|$</span> is too large<ul><li><p class="math-container">\[d = (LU)^{-1} r\]</p></li><li><p class="math-container">\[x = x + d\]</p></li><li><p class="math-container">\[r = b - Ax\]</p></li></ul></li><li>end</li></ul><p>In Julia, a code to do this would solve the linear system <span>$A x = b$</span> in double precision by using a factorization in a lower precision, say single, within a residual correction iteration. This means that one would need to allocate storage for a copy of <span>$A$</span> is the lower precision and factor that copy. The one has to determine what the line <span>$d = (LU)^{-1} r$</span> means. Do you case <span>$r$</span> into the lower precison before the solve or not? <strong>MultiPrecisionArrays.jl</strong> provides data structures and solvers to manage this. The <strong>MPArray</strong> structure lets you preallocate <span>$A$</span> and the low precision copy.</p><p>The submodule <strong>MultiPrecisionArrays.Examples</strong> has an example which we will use for most of the documentation. The function <code>Gmat(N)</code> returns the trapeziod rule discretization of the Greens operator for <span>$-d^2/dx^2$</span> on <span>$[0,1]$</span></p><p class="math-container">\[G u(x) = \int_0^1 g(x,y) u(y) \, dy \]</p><p>where</p><p class="math-container">\[g(x,y) = \left( \begin{array}{l} 
y (1 - x) \ \mbox{if x &gt; y} \\
x (1 -y ) \ \mbox{otherwise}
\end{array}
\right.\]</p><p>LaTeXEquation(raw&quot;&quot;&quot;     \left[\begin{array}{c}         x \
        y     \end{array}\right] &quot;&quot;&quot;)</p><ul><li><p class="math-container">\[g(x,y) = y (1 - x)\]</p>if x &gt; y</li><li><p class="math-container">\[g(x,y) = x (1 -y )\]</p>otherwise</li></ul><p>The code for this is in the <strong>/src/Examples</strong> directory. The file is <strong>Gmat.jl</strong>.</p></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="functions/mplu!/">mplu!: Simple MPArray factorization »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Wednesday 23 August 2023 17:45">Wednesday 23 August 2023</span>. Using Julia version 1.9.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
